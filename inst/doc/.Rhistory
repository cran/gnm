                   family = wedderburn, data = barley)
sites <- pickCoef(biplotModel, "[.]site")
coefs <- coef(biplotModel)
A <- matrix(coefs[sites], nc = 2)
B <- matrix(coefs[-sites], nc = 2)
par(mfrow = c(1, 2))
plot(A, pch = levels(barley$site), xlim = c(-5, 5), ylim = c(-5, 5),
    main = "Site Effects", xlab = "Component 1", ylab = "Component 2")
plot(B, pch = levels(barley$variety), xlim = c(-5, 5), ylim = c(-5, 5),
    main = "Variety Effects", xlab = "Component 1", ylab = "Component 2")
detach(package:gnm)
unloadNamespace("gnm")
 rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
               etastart = rc1$predictors)
theta[!isLinear] <- NA
theta
asLinear <- isLinear
  theta[asLinear] <- glm.fit.e(X[, asLinear],
                                                     family$linkinv(etastart),
                                                     weights = weights,
                                                     offset = offsetConstrained,
                                                     family = family,
                                                     eliminate = NULL)
options(warn = 1)
  theta[asLinear] <- glm.fit.e(X[, asLinear],
                                                     family$linkinv(etastart),
                                                     weights = weights,
                                                     offset = offsetConstrained,
                                                     family = family,
                                                     eliminate = NULL, coefonly = TRUE)
isLinear
 rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
               etastart = rc1$predictors)
asLinear <- isLinear
rc0 <- gnm(Freq ~ r + c + Diag(r,c),
           family = poisson, data = friend)
rc1 <- gnm(Freq ~ r + c + Diag(r,c) + MultHomog(r, c),
           family = poisson, data = friend, etastart = rc0$predictors)
asLinear <- isLinear
unname(theta)
rc1 <- gnm(Freq ~ r + c + Diag(r,c) + MultHomog(r, c),
           family = poisson, data = friend, etastart = rc0$predictors, trace = TRUE)
search()
rc0 <- gnm(Freq ~ r + c + Diag(r,c),
           family = poisson, data = friend)
system.time(rc0 <- gnm(Freq ~ r + c + Diag(r,c),
           family = poisson, data = friend))
rc1 <- gnm(Freq ~ r + c + Diag(r,c) + MultHomog(r, c),
           family = poisson, data = friend, etastart = rc0$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = coef(rc1), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nlevel(r))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nlevels(r))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nlevels(friend$r))), trace = TRUE)
str(friend)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend)), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
debug(gnmFit.e)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
unname(theta)
sum(unspecifiedLin)
initElim
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
debug(gnmFit.e)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
head(theta)
theta[isLinear]
theta[!isLinear]
undebug(gnmFit.e)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
debug(gnmFit.e)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
theta
glm.fit
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
rc1 <- gnm(Freq ~ r + c + Diag(r,c) + MultHomog(r, c),
           family = poisson, data = friend, etastart = rc0$predictors, trace = TRUE)
tmpOffset
head(tmpOffset)
all.equal(unname(etastart), tmpOffset)
resp
rc1 <- gnm(Freq ~ r + c + Diag(r,c) + MultHomog(r, c),
           family = poisson, data = friend, etastart = rc0$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
options(error = recover)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
00000000
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, start = c(coef(rc1), rep(NA, nrow(friend))), trace = TRUE)
rc2 <- update(rc1, . ~ . + MultHomog(r, c, inst = 2),
              etastart = rc1$predictors, trace = TRUE)
rc1 <- gnm(Freq ~ r + c + Diag(r,c) + MultHomog(r, c),
           family = poisson, data = friend, etastart = rc0$predictors, trace = TRUE)
q()
library(gnm)
multCoef <- coef(RChomog1)[pickCoef(RChomog1, "Mult")]
set.seed(1)
RChomogConstrained1 <- update(RChomog1, constrain = 31,
                              start = c(rep(NA, 23), multCoef - multCoef[8]))
coef(RChomog1)
RChomog1
?yaish
options(help_type = "text")
?yaish
     unidiff <- gnm(Freq ~ educ*orig + educ*dest +
                          Mult(Exp(educ), orig:dest), family = poisson,
                          data = yaish, subset = (dest != 7))
data(yaish)
set.sedd(1)
set.seed(1)
     unidiff <- gnm(Freq ~ educ*orig + educ*dest +
                          Mult(Exp(educ), orig:dest), family = poisson,
                          data = yaish, subset = (dest != 7))
 ofInterest(unidiff) <- pickCoef(unidiff, "[.]educ")
     coef(unidiff)
getContrasts(unidiff, ofInterest(unidiff))
tmp <- model.matrix(unidiff)
summary(tmp)
summary(tmp[,62:65])
gnm:::vcov.gnm
head(unidiff$fitted)
head(unidiff$pred)
head(unidiff$resid)
head(unidiff$w)
head(unidiff$y)
q(0
q()
